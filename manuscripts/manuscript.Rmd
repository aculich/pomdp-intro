---
title: "The importance of measurement uncertainty in ecological management"
author:
  - name: "Milad Memarzadeh"
    affiliation: a
  - name: "Carl Boettiger"
    affiliation: a, 1
address:
  - code: a
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"
  

abstract: |
  We settle a long standing paradox in ecological management regarding the influence of measurement uncertainty.  Previous work has frequently suggested that the optimal management of fisheries should respond to increased measurement uncertainty by increasing harvest effort, contrary to intuition and the precautionary principle. Through the use of cutting-edge point-based partially observed Markov decision process (POMDP) methods, we demonstrate how this paradox arises from flaws in the standard management theory, which contributes to over-exploitation of fisheries and increased probability of economic and ecological collapse.  In contrast, we find POMDP-based management avoids such over-exploitation while also generating higher economic value through adaptive learning. 


keywords:
  - Measurement uncertainty
  - POMDP
  - Decision theory
  - Fisheries
  - Conservation

lineno: true

bibliography: citations.bib
csl: the-american-naturalist.csl
output: rticles::elsevier_article
layout: 3p # review # review = doublespace, 3p = singlespace, 5p = two-column

---


```{r libraries, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.width=7, fig.height=7)
library(tidyverse)
library(gridExtra)
```

```{r optional_plot_fonts, message=FALSE}
library(ggplot2)
library(Cairo)
library(extrafont)
library(hrbrthemes)

extrafont::loadfonts()
knitr::opts_chunk$set( dev="cairo_pdf")
hrbrthemes::import_roboto_condensed() 
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
```

```{r plot_colors}
#palette <- ggthemes::ptol_pal()(6)
palette <- c("#D9661F", "#3B7EA1",  "#6C3302", "#FDB515", "#00B0DA",  "#CFDD45") # berkeley colors

colors <- set_names(c(palette[c(1:4,2,5)], "grey", "black"), 
                    c("TAC", "POMDP", "MSY", "CE", 
                      "POMDP: low prior",
                      "POMDP: high prior",
                      "biomass",
                      "catch"))

```


```{r load_data, message=FALSE, warning=FALSE}
log_dir <- "../data/observe_harvest_recruit" # solution files here

## Fig1, Fig2
sims <- read_csv(file.path(log_dir, "sims.csv"), col_types = "inicnnn")

## Fig 3
overest_sims <- read_csv(file.path(log_dir, "overest_sims.csv"))

## Fig 4
policies_w_priors <- read_csv(file.path(log_dir, "policies_w_priors.csv"))

## Fig 5
ram_ex <- read_csv(file.path(log_dir, "../ram_ex/ram_ex.csv"))

```


Imperfect information is ubiquitous in ecological management and conservation decision making. While the pressing concerns of global change have put the spotlight on *forecasting*, i.e. the uncertainty of the future [e.g. @Petchy2015], management decisions must also contend with uncertainty of the *present*: How many fish are in the sea today? What regions harbor the most fragile biodiversity? How have invasive species transformed native communities? A recognition of the importance of uncertainty as well as sophisticated methods and tools to do so has become increasingly widespread in the context of estimating ecological models from available data, thanks in large part to the rise of approaches such as Hierachical Bayesian Modeling, along with convenient software tools for implementing these methods.  In sharp contrast to that shift, the treatment of uncertainty in decisions -- how the uncertainty in models should be reflected in scientific recommendations, remains far less developed, more qualitative, and underserved by available tools.  In this paper we illustrate how uncertainty in measurement has a dramatic negative impact on outcomes under a variety of these exsiting approaches, which can be avoided through the use of more formal approaches that have since been developed in other fields that can likewise be implemented in software tools.  This insight both resolves a long-standing paradox in fisheries management and has important implications for how ecosystem management deals with uncertainty more generally.

Approaches for decision making under uncertainty in ecological systems can be divided into two camps: approaches based in "optimal control" and usually favored by natural resource economists, and approaches based in heuristic methods such as scenario planning, resilience thinking, and precautionary rules of thumb, more commonly found in both ecological literature and actual practice [@Fischer2009; @Polasky2011].  While researchers have for some time recognized the need to unify the transparent and quantitative algorithmic approach of optimal control with the greater complexity and uncertainty of real ecosystems that is acknolwedged by heuristic methods, computational barriers to doing so have hither-to stymied this progress.  Here, we illustrate how the limitations of these approaches has been manifested in the example of fisheries management, and present a new approach that can combine the reality of measurement uncertainty and the rigour of optimization to resolve a long-standing paradox and suggest a more robust approach to management.   

Fisheries conservation and management has long been both a crucible and proving ground for the theory of ecological management more generally, including topics such as adaptive management [@Walters1978], ecosystem-based management [@Levin2008] and resilience thinking [@Holling1973; @May1977], while also giving rise to the sub-discipline of resource economics [@Beverton1957; @Schaefer1954; @Gordon1954], thanks to its global relevance, long history, and readily available data.  Consequently, understanding the impact of measurement uncertainty in this rich and well-studied context will have implications for both resource management and conservation efforts in other domains, many of which draw on concepts established or tested in fisheries ecosystems.  In particular, the approach here illustrates the limitations of both over-simple optimal control approaches and rule-of-thumb precautionary approaches, and offers instead a more general strategy for dealing with measurement uncertainty adaptively.  


We compare the results of managing simulated fish stocks under the existing optimal control approach, a heuristic approach that more closely resembles today's management practices, and a newly proposed approach that provides a more rigorous treatment of uncertainty.

# Model

We consider the management problem of setting catch quotas for a marine fishery in the face of imperfect information about the current stock size and uncertainty about future recruitment.  To facilitate tractability and intepretation, we will focus on the well-studied Gordon-Schaefer model [@Schaefer1954; @Gordon1954] of logistic population growth (stock recruitment),  

$x_{t+1} = x_t r  \left(1 - \frac{x_t}{K}\right) - h_t \varepsilon_t$

where $x_t$ is the current stock size, $h_t$ the harvest chosen that year, with parameters $r$ giving the individual growth rate, and $K$ the carrying capacity and $\varepsilon$ representing stochastic recruitment in a variable environment.  We will assume for simplicity $\varepsilon \sim \mathcal{N}(1, \sigma_g)$.  

This and similar models are widely used in large scale analyses across diverse stocks (e.g. [@Costello2016; @Britten2017]), and form the basis for much of bioeconomic theory [@Clark1990]. As such, it will be easier to compare our results against intuition and classic theory, and avoid the possibility of differences arsing only because of some particular subtle assumption hidden in a more complex model.

However, it is important to remember that both existing methods we discuss and the POMDP approach proposed here can or are already applied to more complex models as well, including those with age or stage structure.  Likewise, while we consider the model and it's parameters as "given," it should be understood to mean that this in practice comes as the result of some model choice and statistical estimation from historical data, frequently accounting for uncertainty in both the process and the measurements [e.g. @].  As we shall see here, having included uncertainty in the model *estimation* in no way excuses us from having to also deal once again with that uncertainty in the decision process.  

# The Decision Problem

We seek to determine the sequence of actions $h_t$ for $t \in [1, ... \infty]$ that maximize the net present value (discounted sum of all future profits) of the fishery.  We will denote the discount rate $\gamma$. For simplicity we will once again follow classic theory and assume a fixed price for fish, (equivalently, measuring our value in units of discounted fish rather than discounted dollars), though again this assumption is easy to relax. Each year, the manager also obtains an estimate $y_t$ of the true $x_t$ stock size,

$$y_t = \xi_t x_t$$

Given an estimated recruitment model along with this measurement of the stock size, the manager must set a harvest quota $h_t$ for that year in order to maximize their expected long term (net) present value:

$$\max_{ \lbrace h_t \rbrace} \mathbb{E} \left \{ \sum_{t=0}^{\infty} \gamma^t \cdot h_t \right \}$$

A few subtlies arise in this seemlingly simple problem statement that we must address.  First, given our discrete-time formulation of the recruitment process, it is necessary to decide if the measurement $y_t$ happens before or after harvest $h_t$: that is do we: measure, recruit, harvest, or measure, harvest, recruit?  Following convention in the optimal control literature (e.g. [@Reed1979; @Clark1990; @Sethi2005]), we will assume the latter; measurement occurs immediately before harvest, followed by recruitment. 

A second subtly is in the nature of the decision problem itself: the optimization problem must always consider the set ${h_t}$ all future actions simultaneously, not merely the next action.  This is a game of chess, where it can be optimal to make costly short term actions (such as closing the fishery) if they pay off in the long run. This differs from the problem solved in theory as well as the practice of maximum sustainable yield, which seeks to identify only a single harvest quota $H_{MSY}$ applied for all time, rather than a *policy* of varying quotas $h_t$ depending on the stock assessment $y_t$.  Understanding this distinction is key both to understanding the differences between current theory and current best practice in fisheries management.


<!-- MDP, POMDP -->

# Current theory and practice

@Gordon1954 and @Schaefer1954 independently showed in the same year that the maximum sustainable yield for the model bearing their names is achieved by reducing the stock to the  population to the size at which it obtains the maximum growth rate which is known as Biomass at Maximum Sustainable Yield, $B_{MSY}$. For the Gordon-Schaefer model (and many others), this is achieved at $B_{MSY} = K/2$.  They observed that fishing at a *constant yield* (that is, an individual fish mortality, $F$, such that harvest $H = F \cdot B$) of $F_{MSY} := \tfrac{H_{MSY}}{B_{MSY}}$)  will eventually lead to a population that converges to the biomass $B_{MSY}$ and produces the maximum sustainable harvest, $H_{MSY} = r K / 4$ in this model.
From here, theory and practice diverge.  

This *constant yield* (constant mortality) solution thus corresponds to an equlibrium analysis, and does not solve the time-dependent optimization problem above. In particular, maximum sustainable yield will not be optimal whenever the stock is away from $B_{MSY}$.  @Clark1973 shows that the optimal time-dependent strategy is not one of constant yield, but rather of *constant escapement*. The time-depednent optimal stategy is impatient: it seeks to achieve the optimal yield as quickly as possible.  Thus, at any level below $B_{MSY}$, the economically optimal thing to do is to completely shut down the fishery, while above this stock, mortalities greater than $F_{MSY}$ can be optimal to bring the stock back to $B_{MSY}$ more quickly.  (This intution must be adjusted slightly in the case of economic discounting of future profits, but is otherwise quite general, see @Clark1990).  This strategy is known as constant escapement, since a constant sock size $B_{MSY}$ escapes harvest each year.  While both converge to the same long-term biomass and long-term yield, these differences away from equilibrium between the mortality-based approach that dominates fisheries management practice and the escapement-based approach that became the focus of theory will result in different behaviors under uncertainty.


<!-- Should TAC go here? -->


The literature of optimal harvests under uncertainty is one of paradoxes, which can only be resolved by a more comprehensive treatment of measurement uncertainty.  

## Reed's Paradox: $S = D$

The first of these we shall refer to as Reed's Paradox, owing to the mathematical proof provided in @Reed1979 which demonstrates that, under sufficiently general assumptions, the optimal escapement $S$ for a population under stochastic growth, is identical to the optimal escapement $D$ of a deterministic population, $S = D = B_{MSY}$.  This suprising result suggests that in going from a world where a manager has perfect knowledge of absolutely everything into a scenario where the manager faces considerable uncertainty about the future state of the world, no additional precaution is needed.  This also provides the manager with a remarkably convenient mechanism for determining the optimal harvest policy: rather than rely on computationally intensive Stochastic Dynamic Programming to determine the optimal policy, a simple derivative will suffice, which is all that is needed to solve the maximum of the deterministic problem.  

## Clark's Paradox: $M < D$

@Clark1986 was among the first attempts to resolve Reed's Paradox. @Clark1986 (quite correctly, as we will see), identified the crux of Reed's Paradox as the absence of measurement uncertainty:

> An important tacit assumption in Reed’s analysis, as in the other works referred
to above, is that the recruitment level X is known accurately prior to the harvest decision, [...] In the case of fishery resources, the stock level X is almost never known very accurately, owing to the difficulty of observing fish in their natural environment.

Unfortunately, @Clark1986 was unable to solve the resulting problem exactly, but had to adopt an almost equally troublesome assumption:

> For reasons of tractability, we shall adopt the simplifying assumption that the escapement level S, is known exactly at the end of that period. (The mathematical difficulty
of the problem increases markedly if this assumption is relaxed.) 

By leveraging algorithms (and also computational hardware) developed over two decades later are we able to crack this mathematical difficulty Clark refers to directly without this "simplyfying assumption."  Unforunately for @Clark1986, this "simplifying assumption" they made instead only deepened the paradox, leading them to find policies that become *less* cautious as uncertainty increases:

> [Our] results appear to contradict the conventional wisdom of renewable resource management, under which high uncertainty would call for increased caution in the setting of quotas.

Using a different but still flawed assumption nearly two decades later, @Sethi2005 largely confirm Clark's Paradox, which they likewise observed with some concern:

> It may seem counter-intuitive that a measurement error causes lower expected escapements below the deterministic fishery closure threshold.

While other attempts to introduce measurement error have been considered, each relies on various approximations that similarly alter the problem, such as assuming the solution must be of 'constant-escapement' type [@Ludwig1981; @Roughgarden1996; @Engen1997;  @Moxnes2003].  Here we will illustrate the use of powerful modern algorithms that will permit a more direct solution to the case of measurement uncertainty.  In addition to resolving this paradox, we will demonstrate this direct solution also out-performs current more heuristic rules of thumb such as those currently used in fisheries management to account for uncertainty.

## Uncertainty in Practice: TAC

Fortunately, management practice has so far ignored this paradoxical suggestion that uncertainty should be met with greater rather than reduced fishing quotas. Maximum Sustainable Yield (MSY) remains the basis of international law (including the UN,  IWC, IATTC, ICCAT, ICNAF; @Mace2001) and a familiar standard of management in terrestrial ecosystems as well as aquatic [@Clark1990].  Critics have for some time observed the limitations of harvesting at MSY in face of uncertainty in stock sizes and population dynamics [@Larkin1977; @Botsford1997].  Many US fisheries reflect this uncertainty through a series of adjustments that effectively reduce the target fishing mortality level to reflect this uncertainty.  Typically, a stock assessment model provides a best estimate of $B_{MSY}$ and corresponding mortality $F_{MSY}$ is used to define the stock Overfishing Limit, (OFL). Based on this, a somewhat lower level is set as the Allowable Biological Catch (ABC), reflecting uncertainty in the stock assessment. To reflect possible uncertainty between reported and actual catch, the ABC is reduced somewhat further to define the Total Allowable Catch, (TAC), which forms the basic unit of management for many such fisheries.  To reflect this process, our analysis will also consider policies in which the harvest quota is set at 80% of the level expected under and MSY policy: $H_{TAC}(t) = 0.8 \cdot F_{MSY} \cdot B_t$, for a biomass estimated at $B(t)$ in year $t$. To distinguish this approach from MSY, we will refer to this approach as a TAC policy.  This more closely represents a heuristic [e.g. @Hilborn2010] or resilience-based approach [sensu @Fischer2009] than an optimization-based policy.  Importantly, this approach shares the fundamentally stationary assumptions of an MSY policy by defining a constant mortality rather than a dynamic policy.  Thus, despite being more cautious overall and generating lower economic yield than a constant escapement policy, TAC policies continue to harvest at non-zero rates even if a stock falls below $B_{MSY}$, while the constant escapement policy does not.  

## POMDPs: An optimal treatment of measurement uncertainty

As discussed above, absent the short-cut provided by Reed's theorems -- solving for the optimal management policy in a stochastically fluctuating population -- involves a Markov Decision Process (MDP), commonly referred to in ecological literature by its solution method, Stochastic Dynamic Programming (SDP). Once measurement uncertainty is introduced, the problem becomes a Partially Observed Markov Decision Process (POMDP, not be confused with a partially observed or hidden Markov model, HMM, in which no decision process is involved).  The POMDP problem is posed identically to that of the MDP problem, with the addition of an observation process.  The POMDP problem for fisheries question considered here can be summarized as follows:

- Transition function (state equation): $T(x_t, x_{t+1}, a_t)$: the probability that a system is in state $x_{t+1}$ at time $t+1$ given that it began in state $x_t$ at time $t$ and the manager took action $a_t$.  In our context, this relationship is given by the Graham-Schaefer stock recruitment function $f$ with normally distributed growth uncertainty $\mathcal{N_T}(f(x_t,a_t), \sigma_g)$, truncated at zero to exclude negative population sizes.

- Observation function: $O(x_t,y_t,a_t)$ the probability of observing state $y$ given a system in state $x$.  In principle, the action chosen can influence the precision of the observation. In our case, we simply assume normally distributed errors around the true state, $y \sim \mathcal{N_T}(x, \sigma_m)$, truncated at zero to exclude negative population sizes.  

- Utility function: $U(x_t,a_t)$, the utility recieved at time $t$ for taking action $a_t$, given that the system is in state $x_t$.  For simplicity of analysis, we will simply set the utility to be equal to the harvested stock: $U(x_t, a_t) = \min(x_t - a_t, 0)$, indicating that realized harvest cannot be negative.  This choice ensures that in the case of no uncertainty ($\sigma_g = \sigma_m = 0$), the optimal solution matches that expected under a simple MSY calculation. More realistic utility functions may include diminishing returns with increasing harvest (supply and demand effects), and the cost of fishing, both of which act to suppress large harvests. By focusing on a simple utility we can be sure that our comparison to MSY is driven by the treatment of uncertainty rather than merely differing economic assumptions.  

The optimization problem is to select the action $a_t$ that will maximize the net present utility over all time. Future utility may be discounted by a factor $\gamma$, so that a value  $V$ in $t$ year is valued at $\gamma^t V$ today.  Numerically, each of these functions are defined over a discrete set of possible states, observations, and actions, and can thus be represented as a collection of matrices or tensors.  As in the case of MDP [@Marescot2013], the POMDP problem can be solved by existing and well-studied algorithms. While not unknown to the conservation literature [@Williams2011], algorithms for POMDP have historically scaled quite poorly, and their application has been restricted to contexts with only a handful of possible states and actions [e.g. @Chades2008; @Chades2011; @Fackler2014; @Fackler2014b].  POMDP algorithms remain a very active area in artificial intellegence, and by adapting recent algorithmic developments [@Kurniawati2008] from that field we are able to find solutions for the considerably more complex problems such as the case of fisheries managment, which requires on the order of 100 states and actions to provide sufficient numerical resolution. Readers interested in the technical details of these algorithms should consult the extensive literature in in POMDP methods. For those interested in exploring or applying these methods, we have developed a preliminary R package [@sarsop-pkg], which can be used to replicate any of the results presented here and explore other variations.  

# Results 


```{r sims, fig.width=7, fig.height=3.5, fig.cap="Average fish biomass under different management strategies under increasing levels of measurement uncertainty. Each plot the mean stock size over time across 100 replicate simulations under each policy: constant escapement (CE), Total allowable catch (TAC = 80% MSY), and the proposed partially observed Markov decision process (POMDP) method. Measurement error increases as a normal distribution with standard deviation 0, 0.1, or 0.15, as indicated at the top of the panel.  Environmental stochasticity is fixed a standard deviation of 0.15 in each panel.  Carrying capacity K normalized to 1, r = 0.75. Additional environmental noise levels and comparison to MSY rather than TAC can be found in the supplementary material. \\label{sims}"}
sims %>%
  select(-value) %>%
  filter(method != "msy", sigma_g == "0.15") %>%
  mutate(method = fct_recode(method, 
                             "CE" = "det",
                             "TAC" = "pgy",
                             "POMDP" = "pomdp")) %>%
  group_by(time, method, sigma_m) %>%
  summarise(mean = mean(state), sd = sd(state)) %>% 
  mutate(sigma_m = as.character(sigma_m)) ->
fig1_df


fig1_df %>%
  ggplot(aes(time, mean, col=method, fill=method)) + 
  geom_line(lwd=1) + 
  geom_ribbon(aes(ymax = mean + sd, ymin = mean-sd), col = NA, alpha = 0.1) +
  facet_wrap(~ sigma_m, labeller = label_bquote(sigma[m] == .(sigma_m))) + 
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  coord_cartesian(ylim = c(0, 1)) + 
  theme(legend.position = "bottom") + 
  ylab("Mean biomass")
```



Figure \ref{sims} shows average fish biomass across 100 replicate simulations under three different management strategies: constant escapement (CE), total allowable catch (TAC; equal to 80% MSY), and partially observed Markov decision process (POMDP) management.  Each successive panel shows a subsequently higher level of measurement error, from $\sigma_m = 0$, $\sigma_m = 0.1$, and $\sigma_m = 0.15$, as indicated.  Standard deviation from the mean across replicate simulations is shown as faint colored bands, indicating significant variation due to stochasticity between individual replicates.  In each panel shown in Figure \ref{sims} stochastic recruitment (environmental noise) is set to a moderate $\sigma_g = 0.15$.  In the absence of either environmental noise or measurement error (Supplemental material, Figure S1) POMDP, CE, and MSY would converge to stock at the $B_{MSY}$, while TAC would maintain the stock at a slightly higher level.  The first panel of Figure \ref{sims} shows that the the introduction of stochastic growth has a significant negative impact on the TAC strategy (This impact is even more severe for MSY, which always harvests strictly more than TAC by definition, as, shown in Supplemental material Figure S2), which results in an average biomass significantly lower than $B_{MSY}$.  Without mesasurement error, the CE and POMDP strategies are nearly identical with both approximately maintaining the stock at $B_{MSY}$ despite the significant environmental stochasticity.  As measurement error increases in the subsequent panels, CE and TAC strategies perform increasingly poorly, while the POMDP continues to maintain the average stock close to $B_{MSY}$.  Notably, CE is significantly more impacted by measurement uncertainty than TAC, with CE averaging even lower biomass than TAC under moderate measurement uncertainty.  

Figure \ref{sims} confirms that the precautionary approach represented by the TAC does indeed prove more robust to the problem of measurement error than the optimization solution represented by CE.  In general, we expect that the rigid assumptions required of optimization will lead to worse outcomes when those assumptions are not met than we see under the corresponding heuristic approach.  Yet it is important to bear in mind that the opposite pattern was observed in the case of environmental stochasticity, in which it was the heuristic TAC stategy rather than the CE strategy that lead to the highest overfishing rate.  In contrast, the POMDP approach successfully handles both stochasticity and observation error, maintaining the stock near $B_{MSY}$ levels that produce the highest yield.  


```{r econ, fig.width=7, fig.height=3.5, fig.cap="\\label{econ}"}
sims %>%
  select(time, value, rep, method, sigma_m, sigma_g) %>%
  filter(sigma_g == "0.15", method != "msy") %>%
  group_by(rep, method, sigma_m, sigma_g) %>%
  summarise(npv = sum(value)) %>%  
  group_by(method, sigma_m, sigma_g) %>%
  summarise(net_value = mean(npv), se = sd(npv) / mean(npv)) %>%
  ungroup() %>%
  mutate(method = fct_recode(method,
                             "CE" = "det",
                             "TAC" = "pgy",
                             "POMDP" = "pomdp")) %>%
  
  
  ggplot(aes(method, net_value, ymin=net_value-se, ymax=net_value+se, fill=method)) + 
  geom_bar(position=position_dodge(), stat="identity") + 
  geom_errorbar(size=.3,width=.2,
                position=position_dodge(.9)) +
  facet_wrap(~sigma_m, 
             labeller = label_bquote(sigma[m] == .(sigma_m))) +
  theme(legend.position = "none") + 
  scale_color_manual(values = colors) +
  scale_fill_manual(values = colors) +
  ylab("expected net present value")
```


This pattern in management success in ecological terms (the relatively recovery and maintenance of fish biomass) is also bourne out in terms of economic performance.  Figure \ref{econ} shows the mean net present value (averaging across replicates and discounting future profits by the discount factor $\gamma$) for these same simulations at increasing levels of measurement uncertainty.  As before, environmental stochasticity is set at $\sigma_g = 0.15$.  In the absense of measurement uncertainty, constant escapement (CE) is optimal, though POMDP performs nearly as well, while TAC underperforms.  As measurement uncertainty increases, the economic value of CE declines, remaining better than TAC at modest measurement error $\sigma_m = 0.1$ but worse at higher uncertainty.  Though the risk of stock collapse does increase with increasing measurement error under TAC (as seen by the mean declines in Figure \ref{sims}), these have little impact on the economic value due to the discount rate.  A smaller discount rate would penalize unlikely but not improbable collapses more, since a significant amount of time is required to realize those rare events.  Supplemental Figure S3 summarizes these economic trends across different noise values $\sigma_g$ and includes comparison to a simple MSY policy.


<!-- Show results of POMDP when over-estimating! -->

```{r overest, fig.width=4, fig.height=3.5, fig.cap = "\\label{overest}"}
overest_sims %>%
  filter(method != "MSY") %>%
  ggplot(aes(time, mean, col=method, fill=method)) + 
  geom_line(lwd = 1) + 
  geom_ribbon(aes(ymax = mean + sd, ymin = mean-sd), col = NA, alpha = 0.1) +
  coord_cartesian(ylim = c(0, 1)) 
```

Figure \ref{overest} summarizes the results of the same simulations under the scenario in which the POMDP approach assumes a measurement error of $\sigma_m = 0.15$, when in fact all simulated measurements are made without error ($\sigma_m = 0$).  This represents an extreme case of ovestimating the measurement error. Stochastic growth remains the same as before, $\sigma_g = 0.15$, and simulations under TAC and CE policies are shown for comparison.  When measurement error is absent, Reed's proofs hold that the CE solution is optimal -- interestingly, the POMDP solutions track almost exactly the CE solution despite the misplaced assumption that measurements are quite poor.  As we have already seen, TAC solution is insufficiently cautious for this level of stochasticicty in recruitment, resulting in overexploitation and long-term decline. The ability of the POMDP solution to perform nearly optimally even when significantly overestimating the level of measurement uncertainty contrasts sharply to the significant declines from ignoring measurement uncertatinty seen in the CE solutions in Figure \ref{sim}.  This demonstrates that while we may not know precisely the level of measurement error, we achieve far better outcomes overestimating measurement uncertainty than underestimating it.  This also underscores the observation that POMDP policy is quite robust to the details of the uncertainty.  We can get a better understanding for the performance of POMDP in these simulations by looking more closely at how any individual decision under a POMDP strategy compares to the action chosen by the current alternatives.  



```{r policy, fig.width=5, fig.height=7, fig.cap="\\label{policy}", message=FALSE, warning=FALSE}
policies_w_priors %>% 
  gather(panel, value, -state, -policy) %>%
  ggplot(aes(state, value, col=policy)) + 
  geom_line(lwd=1)  +
  facet_wrap(~panel, ncol=1, scales = "free_y") +
  scale_color_manual(values = colors) +
  coord_cartesian(xlim = c(0,1), ylim = c(0,.8)) + 
  theme(legend.position = "bottom")
```


To better understand the differences in performance of these strategies and resolve the paradox of uncertainty, we must take a closer look at how the specific action recommended by each policy compares given the same observation.  Figure \ref{policy} shows the action taken by each strategy in response to a measurement of the stock size.  The first panel shows the policy in terms of expected escapement, $S = Y - H$ for observed stock $Y$ and harvest $H$, consistent with most of the relevant control and bioeconomics literature [e.g. @Reed1979; @Clark1986; @Sethi2005].  For comparison, the second panel shows the same policies but in terms of harvest $H$.  These plots clearly illustrate the contrast between the constant escapement (CE) strategy and the precautionary Total Allowable Catch (TAC) strategy: CE sets harvest strictly to zero for stocks estimated at biomass below $B_{MSY}$, while TAC permits a modest harvest of even very small stocks.  Viewing the same policies in terms of escapement, makes it clear that only CE strategy corresponds to keeping escapement constant.  This is important, as theoretical work ever since the proofs of @Reed1979 often attempts to simplify the calculations by assuming the optimal policy must be a constant-escapement type strategy [e.g. @Ludwig1981; @Roughgarden1996; @Engen1997;  @Moxnes2003].  Note that both CE and TAC policies are independent of the levels of uncertainty $\sigma_m$ and $\sigma_g$.  TAC implicitly accounts for some uncertainty through its 80% MSY definition -- comparable plots with MSY can be found in the Supplemental Material.  In principle, the CE policy could depend on $\sigma_g$, but as @Reed1979 proved, the constant escapement level with stochasticity is the same as in the deterministic case, S = D, unless the noise level is quite high (comparison plots in Supplemental material.)  In contrast to this, our POMDP plots depend very much on both the choice of $\sigma_m$ and $\sigma_g$.  If $\sigma_m = 0$, they reduce exactly to the CE solution.  Here we show the corresponding policies for POMDP solutions focusing on $\sigma_g = 0.15$ as above, with a modest measurement uncertainty $\sigma_m = 0.1$.  Alternate combinations of measurement uncertainty can be found in the appendix but do not change the general pattern.  In addition to an explicit dependence on the measurement error, our POMDP solutions depend on another piece of information: any prior observations of the stock size. 

Different attention to prior events fundamentally drives the differences between the POMDP strategy and the other strategies and can resolve the uncertainty paradox.  While the catch quota under both TAC and CE stategies can be completely determined given the most recent observation of the stock size by using the policy curves shown in Figure \ref{policy}, this is not the case for the POMDP approach. This fundamental difference is key to understanding the difference in performance and resolving the paradox of uncertainty.  The POMDP policy cannot be specified by the most recent observation alone. Instead, the POMDP policy depends on all prior observations, not just the most recent.  The reason for this complexity comes from the Markov property.  Observations of the state in the perfectly observed system satisfy the Markov property: once we have measured the current biomass exactly, we cannot get any better estimate of the current stock size by studying older measurements. When measurements are uncertain this is no longer the case: intuitively, by comparing the most recent measurement to previous observations we may be able to infer when any given measurement is unusually high or unusually low.  POMDP formalizes this intutition by capturing the information from all previous observations into a *prior belief*.  This prior belief is updated after every subsequent action and observation in accordance with Bayes Law.  The mechanics of this process are well documented in the extensive literature on POMDPs [e.g. @pomdpstuff; @stuff; @more], but for our purposes it is sufficient to observe how this evolving prior belief serves to continually adjust the POMDP policy.  

Figure \ref{policy} shows two separate policy curves (in terms of harvest and escapement) for the same POMDP solution given two different prior belief distributions (panel 3, priors). While both priors shown express considerable uncertainty about the precise stock size prior to the most recent observation, the lower prior is centered at a value $\tfrac{1}{4}K$ stock size, while the high prior is centered at a value of $\tfrac{3}{4}K$, relative to a (post-harvest, before observation) target size of $B_{MSY} = K/2$.  The POMDP policy is determined by the combination of this prior information and the most recent observation, as indicated by the two different POMDP curves for harvest/escapement shown corresponding to the different priors.  As with the other policies, the higher the most recent observation (x axis) the higher the POMDP recommended harvest.  Yet unlike the alternative strategies, the POMDP solution always reflects the prior information.  Consequently, relative to constant escapement (that is, no measurement error), the POMDP with low prior starts harvesting only at higher stock sizes and always harvests less.  In contrast under the high prior, the POMDP always harvests at the same or higher level than the constant escapement solution.  


**A resolution to the paradox**
Herein lies our resolution to the paradox of uncertainty.  Previous work created this paradox by suggesting that increased harvest rates (decreased target escapement) would often be the rational response to increased uncertainty.  The exact solutions from the POMDP reveal that this is only an accident of the assumptions: it is indeed true that under certain circumstances, harvest levels should increase relative to the case of no uncertainty, but *only when prior knowledge suggests the stock size should be much higher than the most recent estimate would suggest*.  In the POMDP solution, all information must be put into its historical (and constantly updated) context.  When a measurement roughly matches the expectation of this prior context, Figure \ref{policy} shows that the optimal response from POMDP is roughly comparable or slightly more cautious to the harvest under no uncertainty, and not more aggressive as the paradox would suggest. Measurements that exceed expectations are tempered with some skepticism: while the CE solution is willing to meet a high stock measurement with a large harvest, the POMDP solutions increase harvest more cautiously.  

This difference between underestimating and overestimating accounts for the poor performance of the CE solution under large measurement uncertainty, where it over-harvests whenever measurements are too large.  Even though underestimating is equally likely under the measurement uncertainty model, sooner or later a run of "heads", a sequence of overestimations relative to the true stock, can drive stocks to very low levels where chance local extinction becomes possible.  It is precisely this assymetry: that too much overharvesting leads to an irreversible state of extinction, while too much underharvesting is always reversable (modulo some lost revenue) that lay behind Clark's original intutition that there was something fishy about Reed's result that $S = D$: that uncertainty required no extra caution.  Constant escapement is particularly suscpetible to overharvesting starting from stock sizes much higher than $B_{MSY}$ since its bang-bang optimal solution attempts to bring stocks back to target level as fast as possible. CE is not so vulnerable to collapse from small stock sizes, since it shuts down all harvests once estimates fall below $B_{MSY}$. Stock collapse under TAC can also be driven by such a string of heads, but is unlikely at high stock sizes since harvest never exceeds $H_{MSY}$.  In both cases, some measurement uncertainty interacts with inherent stochasticity, which provides a continued source of variation to sizes above $B_{MSY}$, where CE strategy is most vulnerable, and below $B_{MSY}$, where TAC is most vulnerable.



```{r historical, message=FALSE, warning=FALSE, fig.width=7, fig.height = 5, fig.cap="Comparisons of harvest level that would be recommended by policies considered here relative to historical harvest levels in two commercial fish stocks.  POMDP solution assumes a measurement error of 10%. \\label{historical}"}
ram_ex %>%
  filter(model %in% c("biomass", "catch", "POMDP", "Reed", "pgy")) %>%
   mutate(model = fct_recode(model,
                             "CE" = "Reed",
                             "TAC" = "pgy"
                             )) %>%
  ggplot(aes(year, stock, col=model)) +
  geom_line(lwd=1) +
  scale_color_manual(values = colors) +
  facet_wrap(~commonname, scales = "free", ncol=1)  
```


**Historical examples and implementation**.

So far we have focused on simulation and an examination of the relative policies under different prior information.  Figure \ref{histroical} compares the harvest level that would have been recommmended by each of the strategies we have considered here against the historically observed catch recorded for two commericially fished stocks: Argentine Hake and European Plaice.  Historical estimates of biomass and catch are taken from the R.A. Myers Legacy Stock Assessment database [@RAM]. Posterior distributions for parameters for the Graham-Schaefer model are estimated with uncertainty through Markov Chain Monte Carlo using `nimble` [@nimble] on the historical data, illustrating how this process might be done in more complex models as well (details and code in Supplement, Appendix B).  $B_{MSY} and corresponding TAC and CE policies are calculated based on posterior mean estimates of the model parameters, along with POMDP solution assuming a 10% measurement error rate.  Though measurement error could be estimated directly from the raw data, this would not reflect the true measurement uncertainty arising from the stock assessment process.  Each strategy is then compared to historical observations to determine a recommended harvest.  As we have seen, the TAC and CE harvest policies are uniquely determined by the observed stock size relative to $B_{MSY}$, but the POMDP policy must be re-calculated each time step to reflect both the prior observation and prior action.  Note that since we cannot replay history under these alternative policies, so the prior action taken is always the historical catch for that year and not the catch recommended by the POMDP policy.  

These historical examples provide another useful lens to compare how the different strategies respond in the face of fluctuations in real data, rather than model simulations.  In both stocks, historical catch almost always exceeds that recommended by any of our strategies, falling closer to the MSY value estimated (see appendix).   In Argentine Hake, the persistent declines result in both POMDP and CE strategies quicly closing down the fishery in an attempt to let the stock recover to a more productive target biomass, while TAC persists with merely a reduced harvest.  A small recovery of biomass in 1995 is met by an immediate uptick in harvest under CE, while the POMDP response is more conservative.  The example of European Plaice illustrates more volatility in the stock size, revealing further differences in the strategies.  Despite this volatility, the TAC level remains relatively level across all five decades, rising or dipping only slightly with changes in stock size.  In contrast, the CE harvest tracks this volatility almost in perfect mirror.  Here, the POMDP solution falls in between these extremes, almost mirroring which-ever of the two policies is more conservative: the POMDP solution matches the dips in harvest taken by CE to allow the stock to recover most quickly, but does not track the doubling of harvests recommended by CE in the mid 1980, increasingly only to the more modest harvest recommended by the TAC policy.   


Once again, we see that POMDP solution provides a more consistently precautionary policy than either the over-simplified optimal control solution of CE or the more rule-of-thumb approach represented by TAC.  Though we have seen that the POMDP solution need not always be more conservative (lower harvest) than these strategies, it makes use of the all prior observations to tune the level of caution appropriately.  

## Discussion

Using modern algorithms we have been able to crack the nut of measurement uncertainty in the optimal management of marine fisheries and debunk a long-standing paradox that increased measurement uncertainty should be met with larger harvests.  We have illustrated that the POMDP approach introduced here performs consistently better across a range of stochastic growth and measurement error levels, while previous solutions based on either classic optimal control solutions or heuristic rules-of-thumb give significantly worse outcomes in both ecological and economic terms.  Nevertheless, it may be tempting to see these results as either trivial or impractical, but a closer inspection reveals they are neither.

First, It may seem obvious that POMDP would out-proform more primitive optimal control solutions such as CE, but this was hardly a forgone conclusion.  Indeed, the previous example of @Reed1979 had proven that the complex stochastic dynamic programming solutions required to accomidate stochastic dynamics would perform no better than the simple maximization based purely on the deterministic model.  If stochasticity doesn't matter, it is easy to believe that measurement error would be minor at best.  In fact, we find that once we account for measurement error, the effects of both stochasticity and measurement have a significant influence over the optimal policy.  It is similarly tempting to dismiss the better performance of POMDP against a more rule-of-thumb[^1] based strategy like the TAC scenario considered here (fishing at 80% MSY), but once again this was not a forgone conclusion.  While a better economic return might reasonably be expected of the optimization approach, it was not obvious that POMDP would also be at times more cautious than the rule of thumb, able to eek out both higher economic returns by harvesting more when it was safe to do so, and higher ecological recovery by harvesting even less than TAC when necessary.  These results highlight the difficulty of finding effective heuristic rules and underscore the power and utility of more sophisticated strategies such as POMDP which can make the best use of all available information.  

^1: Given the sophisticated policies often in place to determine actual TAC levels, one might object to our characterization of this as merely a rule-of-thumb. We use this term merely to distinguish it from the optimal control approach -- that despite technical precision, TAC adjustments are set by optimal control

If it is not obvious that POMDP solution would do significantly better, one might still ask if such approaches are practical. The importance of simple and effective rules of thumb in conservation management has been well documented [e.g. @Possingham].  Against this we make the following observations.  First, the strategies we have compared against are not purely of academic interest but underpin both current practice and management aspirations.  Together, MSY and TAC-based management reflects much of modern best practice as it is understood in fisheries management and elsewhere; US salmon stocks are one of few examples using a constant escapement-based approach instead. While real-world application of these approaches frequently involves more complex models, the models we have considered here are the ones under which these strategies were designed and tested, and there is little reason to believe they would perform better under more complex cases such as age-structured models that do not always meet those assumptions [e.g. @Holden2015].  The relatively poor ecological and economic performance of these common best-practices relative to the alternative approach of POMDP is thus reason enough for concern.  This issue is further underscored by the reality of both long-running ecological detioriation [@Worm2006; @Worm2009] and economic costs of global fisheries. 


**Are moritoriums pratical?**
Fisheries today are not managed at either their maximum ecological or economic potential.  
Taken as a whole, most ocean fisheries yield a net negative economic return
[@FAO2009], with fishing persisting only with the support of government subsidies [@Arnason2012], 
meanwhile some 68% of global fisheries are in poor biological condition [@Costello2016].
While the causes for this are both complex and numerous, we have seen that both the economic
inefficiency and ecological health suffer under TAC/MSY and CE based management.

**Is computationally intensive management feasible?**
Lastly, one may dismiss the potential of POMDP approaches as being too computationally infeasible for everyday management practices.  In many areas of natural resource management, even simple, rule-of-thumb based methods struggle to take root.  In such a world, how can complex artificial intelligence algorithms requiring significant computational resources to execute play any role?  And yet, in that same world far more complex and demanding algorithms are run every day to provide features such as face recognition to smart phone applications.  If such resources and expertise can now facilitate every day social decisions with only a tap, surely we can one day harness the same complexity and power to facilitate conservation and resource management.



The year-to-year variation in quotas necessary under either a constant escapement policy
or a policy in which quotas are set by POMDP can seem impractical from a top-down
management perspective, particularly when compared to the simplicity of fixing a mortality of fishing $F_{MSY}$.
However, the economist's perspective reveals that this may not be as unrealistic as it may first appear.



Taken as a whole, most ocean fisheries yield a net negative economic return
[@FAO2009], with fishing persisting only with the support of government subsidies [@Arnason2012], 
meanwhile some 68% of global fisheries are not in good biological condition [@Costello2016].
While the causes for this are both complex and numerous, we have seen that both the economic
inefficiency and ecological health are hurt by current policies, including
both MSY and it's more precautionary variants, as these all permit some level of harvest
below $B_{MSY}$.  Economists have for some time observed these inherent 
inefficiencies, and argued that the establishment of property rights in fisheries [@Arnason2012].
Approaches such as individual transferable quotas (ITQs) would incentivise
fisheries behavior to converge towards the more dynamic harvests of a constant
escapement policy, as doing so would increase the value of an individual's share.
@Arnason2012 argues that properly implemented, this would lead fisheries to desire
an even more dynamic adjustment of the TAC to maximize the value of their shares,
rather than to oppose the  @Costello2016 refers to this as Rights Based Fisheries 
Mangement, (RBFM), and it is precisely the willingness to shut down harvests for 
over-exploited fisheries that explains the faster recovery they predict under RBFM
relative to MSY. Though the @Costello2016 RBFM projections are based on a simple 
constant escapement policy which ignores uncertainty, the logic is quite general:
given property rights to establish an efficient market, it is not unrealistic to
expect fisheries adopting such dynamic polices. Indeed, the greater adoption of 
RBFM should spur the adoption of POMDP approaches as rights-holders seek strategies
that maximize the share values.  This is not to dismiss the immense practical
challenges in such an implementation, but to observe that such dynamic, better-performing
policies can be seen to embrace rather than ignore economic realities.  Notably,
the optimization approach assumed in POMDP can be easily adapted to reflect other
constraints such as the cost of idle fleets if a fishery is closed, or include
the value of ecosystem services from fish not harvested [@Halpern2013].  




<!--Alternate utility functions do not increase
the complexity of the solution.  Note that fixed cost of a fleet doesn't alter the answer at all:
if you have the strategy that optimizes your profits when you have no expenses, you don't do a 
different strategy that gets less profit unless it will also lower costs.  So whether or not
you have to pay a fixed fee each year for boats, even if those boats are idle, is no reason
not to leave those boats idle.  only if leaving them idle is *more expensive* than operating them 
does this make sense, which seems unlikely.  -->

<!--
Moreover, regulating fishing effort rather than fishing catch, i.e. opening
a fishery for only certain days of the year rather than limiting dockside catch, is both
economically less efficient: for instance, it increasing costs due to the incentive to use more or larger fishing boats
to maximize catch in that time, and it decreases profits since much of the year's catch
is landed in a short window where it drives down prices, instead of being sold fresh throughout
the year. Because regulating effort is both less direct and more difficult to enforce, the uncertainty
in the expected harvest is also larger than in regulating catch.  
-->

# References 


