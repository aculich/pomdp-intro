---
title: "The importance of measurement uncertainty in ecological management"
author:
  - name: "Milad Memarzadeh"
    affiliation: a
  - name: "Carl Boettiger"
    affiliation: a, 1
address:
  - code: a
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"
  

abstract: |
  We settle a long standing paradox in ecological management regarding the influence of measurement uncertainty.  Previous work has frequently suggested that the optimal management of fisheries should respond to increased measurement uncertainty by increasing harvest effort, contrary to the intuition of the precautionary principle. Through the use of cutting-edge point-based POMDP methods, we demonstrate that the standard management theory which ignores measurement uncertainty may lead to over-exploitation of fisheries and increased probability of economic and ecological collapse.  In contrast, POMDP solutions which account for measurement error are overall more conservative, avoiding over-exploitation while generating higher economic value. 


keywords:
  - Measurement uncertainty
  - POMDP
  - Decision theory
  - Fisheries
  - Conservation

lineno: true

bibliography: citations.bib
output: rticles::elsevier_article
layout: 3p # review # review = doublespace, 3p = singlespace, 5p = two-column

---


```{r libraries, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, dev="CairoPDF", fig.width=7, fig.height=7)
library(tidyverse)
library(gridExtra)
library(ggthemes)
colours <- ptol_pal()(4)
berkeley_colors <- c("#D9661F", "#3B7EA1", "#FDB515", "#6C3302",  "#00B0DA",  "#CFDD45")
```

```{r suggested_libs}
library(hrbrthemes)
library(extrafont)
##extrafont::font_import(prompt=FALSE)    # One-time use to set up fonts, can be slow.
extrafont::loadfonts()
hrbrthemes::import_roboto_condensed()     # One-time use to set up fonts 
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
```

```{r}
log_dir <- "../data/observe_harvest_recruit" # solution files here
```

Imperfect information is ubiquitous in ecological management and conservation decision making. While the pressing concerns of global change have put the spotlight on *forecasting*, i.e. the uncertainty of the future [e.g. @Petchy2015], management decisions must also contend with uncertainty of the *present*: How many fish are in the sea today? What regions harbor the most fragile biodiversity? How have invasive species transformed native communities? A recognition of the importance of uncertainty as well as sophisticated methods and tools to do so has become increasingly widespread in the context of estimating ecological models from available data, thanks in large part to the rise of approaches such as Hierachical Bayesian Modeling, along with convenient software tools for implementing these methods.  In sharp contrast to that shift, the treatment of uncertainty in decisions -- how the uncertainty in models should be reflected in scientific recommendations, remains far less developed, more qualitative, and underserved by available tools.  In this paper we illustrate how uncertainty in measurement has a dramatic negative impact on outcomes under a variety of these exsiting approaches, which can be avoided through the use of more formal approaches that have since been developed in other fields that can likewise be implemented in software tools.  This insight both resolves a long-standing paradox in fisheries management and has important implications for how ecosystem management deals with uncertainty more generally.

Approaches for decision making under uncertainty in ecological systems can be divided into two camps: approaches based in "optimal control" and usually favored by natural resource economists, and approaches based in heuristic methods such as scenario planning, resilience thinking, and precautionary rules of thumb, more commonly found in both ecological literature and actual practice [@Fischer2009; @Polasky2011].  While researchers have for some time recognized the need to unify the transparent and quantitative algorithmic approach of optimal control with the greater complexity and uncertainty of real ecosystems that is acknolwedged by heuristic methods, computational barriers to doing so have hither-to stymied this progress.  Here, we illustrate how the limitations of these approaches has been manifested in the example of fisheries management, and present a new approach that can combine the reality of measurement uncertainty and the rigour of optimization to resolve a long-standing paradox and suggest a more robust approach to management.   

The area of fisheries conservation and management has long been both a crucible and proving ground for the theory of ecological management, including topics such as adaptive management [@Walters1978], ecosystem-based management [@Levin2008] and resilience thinking [@Holling1973; @May1977], while also giving rise to the sub-discipline of resource economics [@Beverton1957; @Schaefer1957], thanks to its global relevance, long history, and readily available data.  Consequently, understanding the impact of measurement uncertainty in this rich and well-studied context will have implications for both resource management and conservation efforts in other domains, many of which draw on concepts established or tested in fisheries ecosystems.  We compare the results of managing simulated fish stocks under the existing optimal control approach, a heuristic approach that more closely resembles today's management practices, and a newly proposed approach that provides a more rigorous treatment of uncertainty.

## Model

We consider the management problem of setting catch quotas for a marine fishery in the face of imperfect information about the current stock size and uncertainty about future recruitment.  To facilitate tractability and intepretation, we will consider a simple and well-studied model of population growth (stock recruitment) in marine fisheries, the Graham-Schaefer model:

Though this and very similar models are widely used in large scale analyses across diverse stocks (e.g. [@Costello2016; @Britten2017]), and common in other conservation contexts where richer models are unavailable, neither the existing approaches nor the one we introduce here are limited to such one-dimensional stochastic models with known parameters. In practice, this model may include age or stage structure and will reflect uncertainty not only in the stochastic recruitment but in the parameters themselves, usually as the result of a heirarchical model estimation process.   All that is required of the model is that it defines the probability of transitioning to a new state given the current state (here, simply the stock size) and the action taken (here, just the harvest).  Uncertainty either in the parameters, in the model, or inherent in the stochastic process can all be reflected in such probabilities. 

Each year, the manager also obtains an estimate $y_t$ of the true $x_t$ stock size, 

$$y_t = Z_m x_t$$
for some measurement error $Z_m$.  Given the estimated recruitment model along with this estimate of the stock size, the manager must set a harvest quota $h_t$ for that year.  The methods we consider here all differ primarily in their handling of these uncertainties. If this system were completely deterministic so that there was no uncertainty, all would produce identical long term policies and thus achieve identical outcomes.  

In the case of no uncertainty, the optimal harvest strategy is to reduce the population to the size at which it obtains the maximum growth rate, known as Biomass at Maximum Sustainable Yield, $B_{MSY}$ (this is adjusted slightly in the case of economic discounting of future profits, but is otherwise quite general, see @Clark1990). For the Graham-Schaefer model (and many others), this is achieved at $B_{MSY} = K/2$, with a corresponding annual harvest of $H_{MSY} = r K / 4$.  

This equilibrium analysis says nothig about the appropriate harvest at stock sizes above or below $B_{MSY}$, which highlights some essential differences between the optimal control policy and more typical fisheries management.  The optimal policy is impatient: it seeks to achieve the optimal yield as quickly as possible.  Below $B_{MSY}$, the economically optimal thing to do is to completely shut down the fishery, while above this stock, a harvest greater than $H_{MSY}$ can be optimal for that year.  This strategy is known as "constant escapement," since a constant sock size $B_{MSY}$ escapes harvest each year.  In practice, it is more common to pursue a policy of constant fishing effort (fishing mortality), $F_{MSY} = H_{MSY} / B_{MSY}$.  Continuing to harvest at $F_{MSY}$ when a stock is above or below $B_{MSY}$ is economically inefficient and causes depleted stocks to rebuild more slowly, but, in the absense of uncertainty, ensures a return in the long run to stock sizes of $B_{MSY}$ and harvests of $H_{MSY}$.  These differences will be important in understanding how these approaches perform once uncertainty is introduced.  

## Pardoxes of uncertainty

The literature of optimal harvests under uncertainty is one of paradoxes, which can only be resolved by a more comprehensive treatment of measurement uncertainty.  

### Reed's Paradox: $S = D$

The first of these we shall refer to as Reed's Paradox, owing to the mathematical proof provided in @Reed1979 which demonstrates that, under sufficiently general assumptions, the optimal escapement $S$ for a population under stochastic growth, is identical to the optimal escapement $D$ of a deterministic population, $S = D = B_{MSY}$.  This suprising result suggests that in going from a world where a manager has perfect knowledge of absolutely everything into a scenario where the manager faces considerable uncertainty about the future state of the world, no additional precaution is needed.  This also provides the manager with a remarkably convenient mechanism for determining the optimal harvest policy: rather than rely on computationally intensive Stochastic Dynamic Programming to determine the optimal policy, a simple derivative will suffice, which is all that is needed to solve the maximum of the deterministic problem.  

### Clark's Paradox: $M < D$

@Clark1986 was among the first attempts to resolve Reed's Paradox. @Clark1986 (quite correctly, as we will see), identified the crux of Reed's Paradox as the absence of measurement uncertainty:

> An important tacit assumption in Reed’s analysis, as in the other works referred
to above, is that the recruitment level X is known accurately prior to the harvest decision, [...] In the case of fishery resources, the stock level X is almost never known very accurately, owing to the difficulty of observing fish in their natural environment.

Unfortunately, @Clark1986 was unable to solve the resulting problem exactly, but had to adopt an almost equally troublesome assumption:

> For reasons of tractability, we shall adopt the simplifying assumption that the escapement level S, is known exactly at the end of that period. (The mathematical difficulty
of the problem increases markedly if this assumption is
relaxed.) 

The resulting solutions only deepened the paradox, rather than recovering a more cautious policy in response to the uncertainty, @Clark1986 finds policies that are often *less* cautious:

> [Our] results appear to contradict the conventional wisdom of renewable resource management, under which high uncertainty would call for increased caution in the setting of quotas.

Using different but still implicitly approximate results nearly two decades later, @Sethi2005 largely confirm Clark's Paradox, which they likewise observe with some concern:

> It may seem counter-intuitive that a measurement error causes lower expected escapements below the deterministic fishery closure threshold.

While other attempts to introduce measurement error have been considered, each relies on various approximations that similarly alter the problem, such as assuming the solution must be of 'constant-escapement' type [@Ludwig1981; @Roughgarden1996; @Engen1997;  @Moxnes2003].  Here we will illustrate the use of powerful modern algorithms that will permit a more direct solution to the case of measurement uncertainty.  First we will introduce the more heuristic alternative to addressing uncertainty, which more accurately reflects both intuition and actual management.  

## Uncertainty in practice

Fortunately, management practice has so far ignored this paradoxical suggestion that uncertainty should be met with greater rather than reduced fishing quotas.  Instead, most well-managaged fisheries operate on rules that are more the result of common sense than mathematical optimization.  While details differ, the basic approach can be thought of as starting with the deterministic notion of $B_{MSY}$ and corresponding optimal fishing level $F_{MSY}$ as a way of determining an Overfishing Limit, (OFL), which is then adjusted to some lower level, Allowable Biological Catch (ABC) to reflect uncertainty in the stock assessment.  ABC is then adjusted lower once again, to determine a Total Allowable Catch, (TAC), reflecting uncertainty in reported catch or other uncertainty.  To capture this process, we will consider a policy in which the harvest quota is set at a TAC of 80% of the level expected under and MSY policy: $H_{TAC}(t) = 0.8 \cdot F_{MSY} \cdot B_t$, for a biomass estimated at $B(t)$ in year $t$. We will refer to both MSY policies and this more cautious adjustment of the MSY policy as "constant mortality" policies, since they are defined by a constant fishing mortality, $F$, rather than by a constant escapement, $S$.  

Note that compared to Reed's constant escapement, this policy still permits some level of harvest even when stocks are measured below $B_{MSY}$.  

## POMDPs: An optimal treatment of measurement uncertainty

As discussed above, absent the short-cut provided by Reed's theorems, solving for the optimal management policy in a stochastically fluctuating population involves a Markov Decision Process (MDP), commonly referred to in ecological literature by its solution method, Stochastic Dynamic Programming (SDP). Once measurement uncertainty is introduced, the problem becomes a Partially Observed Markov Decision Process (POMDP, not be confused with a partially observed or hidden Markov model, HMM, in which no decision process is involved).  The POMDP problem is posed identically to that of the MDP problem, with the addition of an observation process.  The POMDP problem for fisheries question considered here can be summarized as follows:

- Transition function (state equation): $T(x_t, x_{t+1}, a_t)$: the probability that a system is in state $x_{t+1}$ at time $t+1$ given that it began in state $x_t$ at time $t$ and the manager took action $a_t$.  In our context, this relationship is given by the Graham-Schaefer stock recruitment function $f$ with normally distributed growth uncertainty $\mathcal{N_T}(f(x_t,a_t), \sigma_g)$, truncated at zero to exclude negative population sizes.

- Observation function: $O(x_t,y_t,a_t)$ the probability of observing state $y$ given a system in state $x$.  In principle, the action chosen can influence the precision of the observation. In our case, we simply assume normally distributed errors around the true state, $y \sim \mathcal{N_T}(x, \sigma_m)$, truncated at zero to exclude negative population sizes.  

- Utility function: $U(x_t,a_t)$, the utility recieved at time $t$ for taking action $a_t$, given that the system is in state $x_t$.  For simplicity of analysis, we will simply set the utility to be equal to the harvested stock: $U(x_t, a_t) = \min(x_t - a_t, 0)$, indicating that realized harvest cannot be negative.  This choice ensures that in the case of no uncertainty ($\sigma_g = \sigma_m = 0$), the optimal solution matches that expected under a simple MSY calculation. More realistic utility functions may include diminishing returns with increasing harvest (supply and demand effects), and the cost of fishing, both of which act to suppress large harvests. By focusing on a simple utility we can be sure that our comparison to MSY is driven by the treatment of uncertainty rather than merely differing economic assumptions.  

The optimization problem is to select the action $a_t$ that will maximize the net present utility over all time. Future utility may be discounted by a factor $\gamma$, so that a value  $V$ in $t$ year is valued at $\gamma^t V$ today.  


Numerically, each of these functions are defined over a discrete set of possible states, observations, and actions, and can thus be represented as a collection of matrices or tensors.  As in the case of MDP [@Marescot2013], the POMDP problem can be solved by existing and well-studied algorithms. While not unknown to the conservation literature [@Williams2011], algorithms for POMDP have historically scaled quite poorly, and their application has been restricted to contexts with only a handful of possible states and actions [e.g. @Chades2008; @Chades2011; @Fackler2014; @Fackler2014b].  POMDP algorithms remain a very active area in artificial intellegence, and by adapting recent algorithmic developments [@Kurniawati2008] from that field we are able to find solutions for the considerably more complex problems such as the case of fisheries managment, which requires on the order of 100 states and actions to provide sufficient numerical resolution. Readers interested in the technical details of these algorithms should consult the extensive literature in in POMDP methods. For those interested in exploring or applying these methods, we have developed a preliminary R package, @sarsop-pkg, which can be used to replicate any of the results presented here and explore other variations.  

## Results 

<!--
PGY, MSY, Det, MDP (sigma_g), POMDP (sigma_g, sigma_m)
-->


### Replicate simulations 


Figure 1 shows average fish biomass 

```{r fig.cap="Average fish biomass under different management strategies under increasing levels of measurement uncertainty. Each plot the mean stock size over time across 100 replicate simulations under each policy: constant escapement, maximum sustainable yield (MSY), and the porposed partially observed Markov decision process (POMDP) method. Measurement error increases as a normal distribution with standard deviation 0, 0.1, or 0.15, as indicated at the top of the panel.  Environmental stochasticity is fixed a standard deviation of 0.15 in each panel.  Carrying capacity K normalized to 1, r = 0.75. Additional environmental noise levels shown in supplement."}
sims <- read_csv(file.path(log_dir, "sims.csv"), col_types = "inicnn")
sims %>%
  filter(method != "pgy", sigma_g == "0.15") %>%
  mutate(method = fct_recode(method, 
                             "Constant escapement" = "det",
                             "MSY" = "msy",
                             "POMDP" = "pomdp")) %>%
  group_by(time, method, sigma_m) %>%
  summarise(mean = mean(state), sd = sd(state)) %>%
  ggplot(aes(time, mean, col=method, fill=method)) + 
  geom_line() + 
  geom_ribbon(aes(ymax = mean + sd, ymin = mean-sd), col = NA, alpha = 0.1) +
  facet_wrap(~ sigma_m, labeller = label_bquote(sigma[m] == .(sigma_m))) + 
  coord_cartesian(ylim = c(0, 1)) + 
  theme(legend.position = "bottom") + 
  ylab("Mean biomass")
```



POMDP policies depend on the prior belief.  

```{r}
all_policies <- read_csv(file.path(log_dir, "all_policies.csv"))
all_policies %>% 
  filter(policy %in% c("low", "medium", "det", "msy")) %>%
  mutate(policy = fct_recode(policy,
                             "MSY" = "msy",
                             "Constant escapement" = "det",
                             "POMDP: low prior" = "low",
                             "POMDP: medium prior" = "medium"
                             )) %>%
  ggplot(aes(state, harvest, col=policy)) + 
  geom_line(lwd=1)  + 
  coord_cartesian(xlim = c(0,1), ylim = c(0, .8))
```



### Comparisons to historical data




```{r eval=FALSE}
sims %>%
  filter(model %in% c("biomass", "catch", "POMDP", "Reed", "pgy")) %>%
  ggplot(aes(year, stock, col=model)) +
  geom_line(lwd=1) +
  scale_color_manual(values = c("black", "grey", berkeley_colors) ) +
  facet_wrap(~commonname, scales = "free", ncol=1) + theme_bw()  
```


**A POMDP policy reflects all prior observations**.
The essential difference in a POMDP policy compared to either that of constant escapement $S$ or constant mortality $F$ is that nothing is just a constant -- instead, the harvest quota recommended by POMDP will always depend not only on the most recent observation of the stock size, but on all previous stock sizes.  This dependency can be expressed in terms of a *prior belief* -- if all prior observations have led one to expect that the stock should be relatively small, a single observation of a very large stock is met by some skepticism under a POMDP, and the resulting harvest recommended by POMDP can differ substantially from that recommended by constant escapement or constant mortaility, which by definition consider only the most recent observation.  If the observation is largely consistent with prior expectations, a POMDP policy will be more similar to that of the constant escapement policy, though with a natural level of precaution built in to allow for the possibility of error in measurement coupled with a negative shock to growth.  


## Discussion

Is it surprising that POMDP model should do better?  Recall that Reed found stochasticity to make no difference, the deterministic model performs identically.  

### A practical implementation?


The year-to-year variation in quotas necessary under either a constant escapement policy
or a policy in which quotas are set by POMDP can seem impractical from a top-down
management perspective, particularly when compared to the simplicity of fixing a mortality of fishing $F_{MSY}$.
However, the economist's perspective reveals that this may not be as unrealistic as it may first appear.
Fisheries today are not managed at either their maximum ecological or economic potential.  
Taken as a whole, most ocean fisheries yield a net negative economic return
[@FAO2009], with fishing persisting only with the support of government subsidies [@Arnason2012], 
meanwhile some 68% of global fisheries are not in good biological condition [@Costello2016].
While the causes for this are both complex and numerous, we have seen that both the economic
inefficiency and ecological health are hurt by current policies, including
both MSY and it's more precautionary variants, as these all permit some level of harvest
below $B_{MSY}$.  Economists have for some time observed these inherent 
inefficiencies, and argued that the establishment of property rights in fisheries [@Arnason2012].
Approaches such as individual transferable quotas (ITQs) would incentivise
fisheries behavior to converge towards the more dynamic harvests of a constant
escapement policy, as doing so would increase the value of an individual's share.
@Arnason2012 argues that properly implemented, this would lead fisheries to desire
an even more dynamic adjustment of the TAC to maximize the value of their shares,
rather than to oppose the  @Costello2016 refers to this as Rights Based Fisheries 
Mangement, (RBFM), and it is precisely the willingness to shut down harvests for 
over-exploited fisheries that explains the faster recovery they predict under RBFM
relative to MSY. Though the @Costello2016 RBFM projections are based on a simple 
constant escapement policy which ignores uncertainty, the logic is quite general:
given property rights to establish an efficient market, it is not unrealistic to
expect fisheries adopting such dynamic polices. Indeed, the greater adoption of 
RBFM should spur the adoption of POMDP approaches as rights-holders seek strategies
that maximize the share values.  This is not to dismiss the immense practical
challenges in such an implementation, but to observe that such dynamic, better-performing
policies can be seen to embrace rather than ignore economic realities.  Notably,
the optimization approach assumed in POMDP can be easily adapted to reflect other
constraints such as the cost of idle fleets if a fishery is closed, or include
the value of ecosystem services from fish not harvested [@Halpern2013].  


<!--Alternate utility functions do not increase
the complexity of the solution.  Note that fixed cost of a fleet doesn't alter the answer at all:
if you have the strategy that optimizes your profits when you have no expenses, you don't do a 
different strategy that gets less profit unless it will also lower costs.  So whether or not
you have to pay a fixed fee each year for boats, even if those boats are idle, is no reason
not to leave those boats idle.  only if leaving them idle is *more expensive* than operating them 
does this make sense, which seems unlikely.  -->

<!-- True whether or not it is implemented in effort-based control or as a TAC-->


<!--
Moreover, regulating fishing effort rather than fishing catch, i.e. opening
a fishery for only certain days of the year rather than limiting dockside catch, is both
economically less efficient: for instance, it increasing costs due to the incentive to use more or larger fishing boats
to maximize catch in that time, and it decreases profits since much of the year's catch
is landed in a short window where it drives down prices, instead of being sold fresh throughout
the year. Because regulating effort is both less direct and more difficult to enforce, the uncertainty
in the expected harvest is also larger than in regulating catch.  
-->

# References 


